"use strict";let app,wrap,backgrounds,cards;class Card{constructor(t,e,i){this.id=t,this.view=e,this.background=i}getIndex(){for(let t=0;t<cards.size;t++){let e=getByIndex(t);if(null!=e&&e==this)return t}return-1}setActive(t=!0){if(t){this.view.classList.add("active"),this.background.classList.add("active");let t=this.view.querySelector("img");if(null!=t&&(t.setAttribute("width",""+Card.width*Card.multiplier),t.setAttribute("height",""+Card.height*Card.multiplier)),this.view.focus(),null==wrap)return;let e=this.getIndex();if(-1==e)return;let i=e*(Card.width+Card.margin);wrap.scrollTo(i,0)}else{this.view.classList.remove("active"),this.background.classList.remove("active");let t=this.view.querySelector("img");null!=t&&(t.setAttribute("width",`${Card.width}`),t.setAttribute("height",`${Card.height}`))}}}function initDOM(){if(app=document.querySelector("#app"),null==app)throw new Error("Could not retrieve app DOM.");if(wrap=document.querySelector("#wrap"),null==wrap)throw new Error("Could not retrieve wrap DOM.");backgrounds=document.createElement("div"),backgrounds.id="backgrounds",app.appendChild(backgrounds)}function initCards(){cards=new Map;let t=document.getElementsByClassName("card");for(let e=0;e<t.length;e++){let i=t[e];i.setAttribute("href","javascript:void(0)");let r=Number(i.id.substr(5)),a=document.createElement("div");a.id=`background-${r}`,a.classList.add("background"),0==e&&a.classList.add("active"),backgrounds.appendChild(a);let s=document.createElement("img");s.classList.add("lazyload"),s.setAttribute("data-sizes","auto"),s.setAttribute("data-src",`assets/images/backdrops/1080p/${r}.webp`),s.setAttribute("data-srcset",`assets/images/backdrops/1080p/${r}.webp 1x, assets/images/backdrops/2160p/${r}.webp 2x`),s.setAttribute("width",String(window.innerWidth)),s.setAttribute("height",String(window.innerHeight)),s.setAttribute("loading","lazy"),s.setAttribute("alt",""),a.append(s);let n=new Card(r,i,a);cards.set(e,n)}}function getByIndex(t){return cards.get(t)}function getById(t){for(let e=0;e<cards.size;e++){let i=getByIndex(e);if(null!=i&&i.id==t)return i}}function getActive(){for(let t=0;t<cards.size;t++){let e=getByIndex(t);if(null!=e&&e.view.classList.contains("active"))return e}}function initHandlers(){if(document.addEventListener("keydown",(t=>{let e=-1,i=cards.keys().next().value;switch(t.code){case"ArrowLeft":t.preventDefault(),t.stopPropagation(),cards.forEach(((t,r)=>{t.view.classList.contains("active")&&(e=i),i=r}));break;case"ArrowRight":t.preventDefault(),t.stopPropagation(),cards.forEach(((t,r)=>{let a=getByIndex(i);null!=a&&a.view.classList.contains("active")&&(e=r),i=r}))}if(-1!=e){let t=getActive();null!=t&&t.setActive(!1);let i=getByIndex(e);null!=i&&i.setActive()}})),cards.forEach(((t,e)=>{t.view.addEventListener("click",(()=>{let e=getActive();null!=e&&e.setActive(!1),t.setActive()})),t.view.addEventListener("focus",(()=>{let e=getActive();null!=e&&e.setActive(!1),t.setActive()}))})),null==wrap)return;let t;wrap.addEventListener("scroll",(()=>{window.clearTimeout(t),t=window.setTimeout((()=>{if(null!=wrap){var t;if(null!=(t=getByIndex(Math.round(wrap.scrollLeft)/(Card.width+Card.margin)))){let e=getActive();null!=e&&e.setActive(!1),t.setActive()}if(null!=(t=getByIndex((Math.round(wrap.scrollLeft)-Card.width*Card.multiplier-Card.margin)/(Card.width+Card.margin)+1))){let e=getActive();null!=e&&e.setActive(!1),t.setActive()}}}),300)}))}Card.width=190,Card.height=9*Card.width/16,Card.margin=16,Card.multiplier=1.5,document.addEventListener("DOMContentLoaded",(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js"),initDOM(),initCards(),initHandlers();let t=getByIndex(cards.keys().next().value);null!=t&&t.setActive()}));
